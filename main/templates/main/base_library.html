
{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{% block title %}NearBeats{% endblock %}</title>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">
  
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

  <!-- Estilos -->
  <link rel="icon" href="{% static 'main/images/Logo_NearBeats.png' %}" type="image/png" />
  <link rel="stylesheet" href="{% static 'main/css/style_BaseLibrary.css' %}?v=1">
  <link rel="stylesheet" href="{% static 'main/css/styleLibrary.css' %}?v=1">
  <link rel="stylesheet" href="{% static 'main/css/estilo.css' %}?v=1">
   {% block extra_css %}{% endblock %}

  <!-- Scripts -->
  <script src="{% static 'main/js/search.js' %}"></script>
  <script src="{% static 'main/js/player.js' %}"></script>
  <script src="{% static 'main/js/like.js' %}"></script>
  <script src="{% static 'main/js/favorite.js' %}"></script>


</head>

<body>
  <!-- Sidebar -->
  <aside class="sidebar fade-in">
    <div class="logo-container">
      <div class="logo">
        <img src="{% static 'main/images/Logo_NearBeats.png' %}" alt="NearBeats">
        <span class="brand-name">NearBeats</span>
      </div>
      <div class="divider"></div>
    </div>

    <ul class="nav-links">
      <li>
        <a href="{% url 'library' %}" 
           class="{% if request.resolver_match.url_name == 'library' %}active{% endif %}">
           <i class="bi bi-search"></i> Explorar
        </a>
      </li>

      {% if user.is_authenticated and user.rol == "Artista" %}
        <li>
          <a href="{% url 'upload_songs' %}" 
             class="{% if request.resolver_match.url_name == 'upload_songs' %}active{% endif %}">
             <i class="bi bi-cloud-upload"></i> Subir canciones
          </a>
        </li>
      {% endif %}

      <li>
        <a href="#" 
           class="">
           <i class="bi bi-music-note-list"></i> Playlists
        </a>
      </li>

      <li>
        <a href="{% url 'favorites' %}" 
           class="{% if request.resolver_match.url_name == 'favorites' %}active{% endif %}">
           <i class="bi bi-star-fill"></i> Favoritos
        </a>
      </li>
    </ul>

    <!-- Usuario logueado / no logueado -->
    <div class="bottom-buttons mt-auto p-2">
      {% if user.is_authenticated %}
        <div class="dropdown w-100">
          <button class="btn d-flex align-items-center justify-content-between w-100 bg-white shadow-sm rounded-3 px-3 py-2"
                  type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false"
                  style="border: none;">
            <div class="d-flex align-items-center">
              <img src="{% static 'main/images/default_profile.jpeg' %}" 
                   alt="Foto de perfil" 
                   class="rounded-circle me-2"
                   style="width: 36px; height: 36px; object-fit: cover;">
              <div>
                <div class="fw-semibold" style="font-size: 0.9rem;">{{ user.nombre }}</div>
                <div class="text-muted" style="font-size: 0.75rem;">
                  {% if user.is_superuser %}
                    Administrador
                  {% else %}
                    {{ user.rol }}
                  {% endif %}
                </div>
              </div>
            </div>
            <i class="bi bi-chevron-up small text-muted ms-2"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm mt-1 w-100" aria-labelledby="userDropdown">
            <li>
              <a class="dropdown-item text-danger fw-medium" href="{% url 'logout' %}">
                <i class="bi bi-box-arrow-right me-2"></i> Cerrar sesiÃ³n
              </a>
            </li>
          </ul>
        </div>
{% else %}
<a href="{% url 'login' %}" class="login-card">
  <div>
    <div class="login-title">ðŸŽ¶ Inicia sesiÃ³n</div>
    <div class="login-subtitle">
      y desbloquea tu <span>experiencia musical</span>
    </div>
  </div>
</a>

{% endif %}
  </div>
  </aside>
  

  <!-- Contenido principal -->
 <main class="main-content fade-in" >
  <!-- Barra de navegaciÃ³n secundaria -->
{% include 'main/main_navbar.html' %}

  <!-- Contenido especÃ­fico de cada pÃ¡gina -->
  {% block content %}{% endblock %}
</main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
